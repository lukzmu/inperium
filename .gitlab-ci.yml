image: python:3.12-slim

stages:
  - lint
  - publish

before_script:
  - pip install poetry
  - poetry install
  - export PYTHONPATH="$PYTHONPATH:./src"

🖤 black:
  stage: lint
  script: poetry run black --check --diff src/

🐶 ruff:
  stage: lint
  script: poetry run ruff src/

🍰 mypy:
  stage: lint
  script: poetry run mypy src/

pages:
  stage: publish
  only: 
    - main
  needs:
    - 🖤 black
    - 🐶 ruff
    - 🍰 mypy
  script: 
    - cd src
    - poetry run pelican content -s core/settings.py -o ../public
  artifacts:
    paths:
      - public
